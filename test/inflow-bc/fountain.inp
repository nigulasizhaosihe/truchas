INVISCID FLUID FILLING A PIPE WITH VOID
---------------------------------------
This is simple 1D inviscid fluid/void flow problem. The 2D 5x1 pipe domain is
initially void. There is a velocity BC of 1 at
the left inlet boundary, and a compatible initial fluid velocity of 1. Fluid
gradually fills the pipe with the fluid/void interface moving with speed 1.
The simulation ends before the pipe is completely filled with fluid.

We should recover the exact solution: P=0, V=(1,0,0) on cells with
fluid, with the fluid/void interface moving at speed 1 to the right.

&MESH
  mesh_file = 'fountain.gen'
/

&OUTPUTS
  output_t  = 0.0, 20.0
  output_dt = 0.1
/

A kludge to force hitting the final time exactly
x&SIMULATION_CONTROL
  phase_start_times = 4.0
  phase_init_dt_factor = 1.0
/

&PHYSICS
  flow = .true.
  body_force_density = 0.0, 0.0, -0.5
/

&NUMERICS
  dt_init = 1.0e-2
  dt_grow = 1.05
  dt_min  = 1.0e-10
  dt_max  = 1.0
/

&FLOW
  !inviscid = t
  courant_number = 0.125
  subcycles = 2
  nested_dissection = f
  viscous_implicitness = 0.5
  viscous_number = 0.5
/

&FLOW_VISCOUS_SOLVER
  rel_tol = 1e-9
  !abs_tol = 1e-12
  max_ds_iter = 100
  max_amg_iter = 20
  krylov_method = "cg"
/

&FLOW_PRESSURE_SOLVER
  rel_tol = 1e-9
  abs_tol = 1e-12
  max_ds_iter = 100
  max_amg_iter = 20
  krylov_method = "cg"
/

&FLOW_BC
  name = 'inlet'
  condition = 'velocity'
  face_set_ids = 1
  data_constant = 0.0, 0.0, 1.0
  inflow_material = 1
/

All void initially
&BODY
  surface_name = 'from mesh file'
  mesh_material_number = 1
  material_number = 2
  velocity = 0.0, 0.0, 0.0
  temperature = 0.0
/

&MATERIAL
  material_name = 'water'
  material_number = 1
  density = 1.0 ! not void
/

&PHASE
  name = 'water'
  property_name(1) = 'density', property_constant(1) = 1.0
  property_name(2) = 'viscosity', property_constant(2) = 1.0e-2
/

&MATERIAL_SYSTEM
  name = 'water'
  phases = 'water'
/

&MATERIAL
  material_name = 'void'
  material_number = 2
  density = 0.0
  material_feature = 'background'
/
